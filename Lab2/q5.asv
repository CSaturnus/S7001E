[X, fs] = audioread('newspapers.wav');

lambda = 099995;
Step_size = 10^-5;

L = X(:,1);
R = X(:,2);

L2=mean(X(1:100,1).^2)
R2=mean(X(1:100,2).^2)


k = zeros(length(X),1);

for i=2:length(X)
    dQdk = L2 + k(i-1) * L2 * R2 + R2;
    L2=(1-lambda)*X(i,1)^2+lambda*L2;
    R2=(1-lambda)*X(i,1)^2+lambda*R2;
    LR = (1 - lambda) * L(i) * R(i) + lambda * LR;

    k(i) = k(i-1) - Step_size * sign(dQdk);
end